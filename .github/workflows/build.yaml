name: "Build PDF and Release"
on:
  push:
    branches:
      - main
    paths-ignore:
      - '**/*.md'
      - .gitignore
      - .overleaf

jobs:
  build-tex-sources:
    name: 'Build TeX Sources'
    runs-on: ubuntu-latest
    steps:
      - name: Check Out Code
        uses: actions/checkout@v2
      - name: Build PDF Document
        run: make PDFOUT_BASENAME=resume-$(date --iso-8601) pdf
      - name: Cut Release
        uses: ncipollo/release-action@v1
        with:
          env:
            DATE=$(date -u +"%Y%m%dT%H%M%S")
          artifacts: "src/resume-*.pdf"
          token: ${{ secrets.GITHUB_TOKEN }}
          tag: ${{ env.DATE }}
          artifactContentType: "application/x-pdf"
